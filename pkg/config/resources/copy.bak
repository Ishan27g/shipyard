package types

// TypeCopy copies files from one location to another
const TypeCopy ResourceType = "copy"

// Docs allows the running of a Docusaurus container which can be used for
// online tutorials or documentation
type Copy struct {
	ResourceInfo `hcl:",remain" mapstructure:",squash"`

	Depends []string `hcl:"depends_on,optional" json:"depends,omitempty"`

	Source      string `hcl:"source" json:"source"`                              // Source file, folder or glob
	Destination string `hcl:"destination" json:"destination"`                    // Destination to write file or files to
	Permissions string `hcl:"permissions,optional" json:"permissions,omitempty"` // Permissions 0777 to set for written file

	CopiedFiles []string `json:"copied_files" mapstructure:"copied_files" state:"true"`
}

// New creates a new Nomad job config resource, implements Resource New method
func (t *Copy) New(name string) Resource {
	return &Copy{ResourceInfo: ResourceInfo{Name: name, Type: TypeCopy, Status: PendingCreation}}
}

// Info returns the resource info implements the Resource Info method
func (t *Copy) Info() *ResourceInfo {
  return &t.ResourceInfo
}

func (t *Copy) Parse(file string) {
	t.Source = ensureAbsolute(t.Source, file)
	t.Destination = ensureAbsolute(t.Destination, file)
}
